<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro de Obra</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #000; /* fundo preto da página */
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh; /* ocupa toda a altura da tela */
      margin: 0;
    }

    .form-container {
      background-color: #fff; /* fundo branco do formulário */
      padding: 2rem;
      border-radius: 10px;
      width: 100%;
      max-width: 500px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    }

    .btn-custom {
      background-color: #000; /* botão preto */
      color: #fff;            /* texto branco */
      border: none;
    }

    .btn-custom:hover {
      background-color: #333; /* tom mais claro no hover */
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h2 class="mb-4 text-center">Cadastro de Obra</h2>
    <form id="form">
      <div class="mb-3">
        <input type="text" class="form-control" id="arte" placeholder="Nome da obra">
      </div>
      <div class="mb-3">
        <input type="text" class="form-control" id="artista" placeholder="Artista">
      </div>
      <div class="mb-3">
        <input type="text" class="form-control" id="categoria" placeholder="Categoria">
      </div>
      <div class="mb-3">
        <input type="text" class="form-control" id="img" placeholder="URL da imagem">
      </div>
      <div class="mb-3">
        <textarea class="form-control" id="sobre" placeholder="Sobre artista e obra"></textarea>
      </div>
      <div class="mb-3">
        <textarea class="form-control" id="conservacao" placeholder="Como conservar esta arte?"></textarea>
      </div>
      <div class="d-flex justify-content-between">
        <button type="submit" class="btn btn-custom">Salvar</button>
        <button type="button" id="deleteBtn" class="btn btn-custom">Excluir</button>
        <a href="index.html" class="btn btn-custom">Voltar</a>
      </div>
    </form>
  </div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    if (id) {
      // Carregar dados para edição
      fetch(`http://localhost:3000/galeria/${id}`)
        .then(res => res.json())
        .then(item => {
          document.getElementById("arte").value = item.arte;
          document.getElementById("artista").value = item.artista;
          document.getElementById("categoria").value = item.categoria;
          document.getElementById("img").value = item.img;
          document.getElementById("sobre").value = item["sobre artista e obra"];
          document.getElementById("conservacao").value = item["como conservar esta arte?"];
        });
    }

    document.getElementById("form").addEventListener("submit", e => {
      e.preventDefault();
      const obra = {
        arte: document.getElementById("arte").value,
        artista: document.getElementById("artista").value,
        categoria: document.getElementById("categoria").value,
        img: document.getElementById("img").value,
        "sobre artista e obra": document.getElementById("sobre").value,
        "como conservar esta arte?": document.getElementById("conservacao").value,
        nova: true // marca automaticamente como nova
      };

      fetch(`http://localhost:3000/galeria${id ? "/" + id : ""}`, {
        method: id ? "PUT" : "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(obra)
      })
      .then(() => {
        alert("Obra salva com sucesso!");
        window.location.href = "index.html"; // redireciona para index.html
      });
    });

    document.getElementById("deleteBtn").addEventListener("click", () => {
      if (id) {
        fetch(`http://localhost:3000/galeria/${id}`, { method: "DELETE" })
          .then(() => {
            alert("Obra excluída com sucesso!");
            window.location.href = "index.html"; // volta para index.html após excluir
          });
      } else {
        alert("Nenhuma obra selecionada para exclusão.");
      }
    });
  </script>
</body>
</html>
